<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
  <style>
    @font-face {
      font-family: GlassTTY;
      src: url(Glass_TTY_VT220.ttf);
    }    
    * {
      font-family: monospace;
      font-size: 14px;
    }   
    body {
      margin: 0;
      font-family: 'Arial', sans-serif;
      overflow-x: hidden; /* Prevent horizontal scrolling on smaller screens */
      position: relative;
    }

    header {
      background-color: #101319;
      color: #54c36b;
      text-align: center;
      padding: 10px;
      font-size: 16px;
    }

    #map-container {
      position: relative;
      width: 100%;
      overflow: hidden;
    }

    #campus-map {
      width: 100%;
      height: auto;
      display: block;
    }

    .user-marker {
      position: absolute;
      width: 15px;
      height: 15px;
      border-radius: 50%;
      background-color: red; /* User's marker color */
      transform: translate(-50%, -50%);
    }

    .blue-marker {
      position: absolute;
      width: 45px; /* Size of the marker image */
      height: 45px; /* Size of the marker image */
      background-image: url('marker.png');
      background-size: cover;
      transform: translate(-50%, -50%);
      animation: blink 2s ease-in infinite alternate; /* Blinking animation */
    }

    canvas {
      position: absolute;
      top: 0;
      left: 0;
      z-index: 10; /* Ensure the canvas is above the map */
      margin-top: 80px;
    }

    /* @keyframes blink {
      from {
        opacity: 1;
      }
      to {
        opacity: 0.1;
      }
    } */

    /* Trivia Modal Styling */
    #triviaModal {
      color: #54c36b;

    }

    .modal-content {
      background-color: #101319;
      border: 3px #54c36b solid;
      border-radius: 0px;

      
    }

    .answer-option {
      margin-top: 10px;
      background-color: #101319;
      border: 3px #54c36b solid;
      font-weight: bold;
    }
    .modal-header {
      border-bottom: #54c36b 2px solid;
      font-weight: bolder;
    }
    .close {
    color: #54c36b;
    font-weight: bolder;
    }
  </style>
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      // Manually placed marker coordinates
      const markers = [
        { label: 'AW', top: 591.72, left: 192.942 },
        { label: 'Env Sci', top: 503.87, left: 234.986 },
        { label: 'Makers Space', top: 445.3, left: 232.27 },
        { label: 'Western Gallery', top: 378.91, left: 240.916 },
        { label: 'Miller Hall', top: 315.42, left: 255.444 },
        { label: 'Wilson Library', top: 222.687, left: 229.025 },
        { label: 'Viking Union', top: 85.101, left: 270.409 }
      ];

      // Display user marker on the map
      const userMarker = document.createElement("div");
      userMarker.className = "user-marker";
      //userMarker.style.top = "50%"; 
      //userMarker.style.left = "50%"; 
      document.getElementById("map-container").appendChild(userMarker);

      // Add manually placed markers with 'marker.png' for specified locations
      markers.forEach(marker => {
        const markerElement = document.createElement("div");
        markerElement.className = "blue-marker";
        markerElement.style.top = marker.top + "px";
        markerElement.style.left = marker.left + "px";
        markerElement.title = marker.label;
        document.getElementById("map-container").appendChild(markerElement);

        markerElement.addEventListener("click", function () {
          showTriviaQuestion(marker.label);
        });
      });
    });

    // Trivia Modal Logic
    function showTriviaQuestion(sectionLabel) {
      var questionAndAnswers = getQuestionAndAnswersBySection(sectionLabel);

      document.getElementById('questionText').textContent = questionAndAnswers.question;

      var answerButtons = document.querySelectorAll('.answer-option');
      var randomizedAnswers = questionAndAnswers.answers.slice().sort(() => Math.random() - 0.5);

      answerButtons.forEach(function (button, i) {
        button.textContent = randomizedAnswers[i];
        button.classList.remove('btn-success', 'btn-danger');
        button.classList.add('btn-secondary');
        if (randomizedAnswers[i] === questionAndAnswers.correctAnswer) {
          button.dataset.correct = true;
        } else {
          button.dataset.correct = false;
        }
      });

      $('#triviaModal').modal('show');
    }

    function checkAnswer(clickedButton) {
      if (clickedButton.dataset.correct === 'true') {
        clickedButton.classList.remove('btn-secondary');
        clickedButton.classList.add('btn-success');

        var blurredSection = document.querySelector('.blue-marker[title="' + clickedButton.dataset.section + '"]');
        if (blurredSection) {
          blurredSection.style.opacity = '0';
        }
      } else {
        clickedButton.classList.remove('btn-secondary');
        clickedButton.classList.add('btn-danger');

        setTimeout(function () {
          clickedButton.classList.remove('btn-danger');
          clickedButton.classList.add('btn-secondary');
        }, 1000);
      }

      setTimeout(function () {
        $('#triviaModal').modal('hide');

        var answerButtons = document.querySelectorAll('.answer-option');
        answerButtons.forEach(function (button) {
          button.classList.remove('btn-success', 'btn-danger');
          button.classList.add('btn-secondary');
          button.dataset.correct = '';
        });

        var allSections = document.querySelectorAll('.blue-marker');
        allSections.forEach(function (section) {
          section.style.opacity = '1';
        });
      }, 1000);
    }

    function getQuestionAndAnswersBySection(sectionLabel) {
      switch (sectionLabel) {
        case 'AW':
          return {
            question: 'What is AW?',
            answers: ['Answer 1', 'Answer 2', 'Answer 3', 'Answer 4'],
            correctAnswer: 'Answer 1'
          };
        case 'Env Sci':
          return {
            question: 'What is Env Sci?',
            answers: ['Answer 1', 'Answer 2', 'Answer 3', 'Answer 4'],
            correctAnswer: 'Answer 2'
          };
        // Add more cases for each section
        default:
          return {
            question: 'Default Question',
            answers: ['Option 1', 'Option 2', 'Option 3', 'Option 4'],
            correctAnswer: 'Option 1'
          };
      }
    }
  </script>
</head>
<body>

  <header class="navbar">
    <span class="navbar-brand  h1">// Campus Map Game</span>
    #########################################
  </header>

  <div id="map-container">
    <img id="campus-map" src="map3.webp" alt="Campus Map" class="img-fluid">
  </div>

  <div class="container mt-3">
    <p id="user-coordinates" class="lead text-center">User Coordinates: Latitude - Longitude</p>
  </div>

  <!-- Trivia Modal -->
  <div class="modal fade" id="triviaModal" tabindex="-1" role="dialog" aria-labelledby="triviaModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="triviaModalLabel">Trivia Question</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <p id="questionText"></p>
          <button class="btn btn-secondary answer-option" onclick="checkAnswer(this)"></button>
          <button class="btn btn-secondary answer-option" onclick="checkAnswer(this)"></button>
          <button class="btn btn-secondary answer-option" onclick="checkAnswer(this)"></button>
          <button class="btn btn-secondary answer-option" onclick="checkAnswer(this)"></button>
        </div>
      </div>
    </div>
  </div>

</body>
</html>
